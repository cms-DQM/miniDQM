<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Create and update THStack object</title>
  </head>
  <body>
    <h3>THStack nostack;hist</h3>
    <div id="id_stack" style="width: 800px; height: 600px"></div>

    <h3>hist</h3>
    <div id="id_hist" style="width: 800px; height: 600px"></div>
  </body>

  <script type="module">
    let obj1 = {
      _typename: "TH1F",
      fUniqueID: 0,
      fBits: 262152,
      fName: "effic_pfjeteta",
      fTitle: "Jet efficiency vs #eta",
      fLineColor: 602,
      fLineStyle: 1,
      fLineWidth: 1,
      fFillColor: 0,
      fFillStyle: 1001,
      fMarkerColor: 1,
      fMarkerStyle: 1,
      fMarkerSize: 1,
      fNcells: 52,
      fXaxis: {
        _typename: "TAxis",
        fUniqueID: 0,
        fBits: 0,
        fName: "xaxis",
        fTitle: " PF Jet #eta",
        fNdivisions: 510,
        fAxisColor: 1,
        fLabelColor: 1,
        fLabelFont: 42,
        fLabelOffset: 0.005,
        fLabelSize: 0.035,
        fTickLength: 0.03,
        fTitleOffset: 1,
        fTitleSize: 0.035,
        fTitleColor: 1,
        fTitleFont: 42,
        fNbins: 50,
        fXmin: -5,
        fXmax: 5,
        fXbins: [],
        fFirst: 0,
        fLast: 0,
        fBits2: 0,
        fTimeDisplay: false,
        fTimeFormat: "",
        fLabels: null,
        fModLabs: null,
      },
      fYaxis: {
        _typename: "TAxis",
        fUniqueID: 0,
        fBits: 0,
        fName: "yaxis",
        fTitle: " efficiency",
        fNdivisions: 510,
        fAxisColor: 1,
        fLabelColor: 1,
        fLabelFont: 42,
        fLabelOffset: 0.005,
        fLabelSize: 0.035,
        fTickLength: 0.03,
        fTitleOffset: 0,
        fTitleSize: 0.035,
        fTitleColor: 1,
        fTitleFont: 42,
        fNbins: 1,
        fXmin: 0,
        fXmax: 1,
        fXbins: [],
        fFirst: 0,
        fLast: 0,
        fBits2: 0,
        fTimeDisplay: false,
        fTimeFormat: "",
        fLabels: null,
        fModLabs: null,
      },
      fZaxis: {
        _typename: "TAxis",
        fUniqueID: 0,
        fBits: 0,
        fName: "zaxis",
        fTitle: "",
        fNdivisions: 510,
        fAxisColor: 1,
        fLabelColor: 1,
        fLabelFont: 42,
        fLabelOffset: 0.005,
        fLabelSize: 0.035,
        fTickLength: 0.03,
        fTitleOffset: 1,
        fTitleSize: 0.035,
        fTitleColor: 1,
        fTitleFont: 42,
        fNbins: 1,
        fXmin: 0,
        fXmax: 1,
        fXbins: [],
        fFirst: 0,
        fLast: 0,
        fBits2: 0,
        fTimeDisplay: false,
        fTimeFormat: "",
        fLabels: null,
        fModLabs: null,
      },
      fBarOffset: 0,
      fBarWidth: 1000,
      fEntries: 63851,
      fTsumw: 0,
      fTsumw2: 63851,
      fTsumwx: -5107.36163998346,
      fTsumwx2: 212532.115736112,
      fMaximum: -1111,
      fMinimum: -1111,
      fNormFactor: 0,
      fContour: [],
      fSumw2: [
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        ,
        0,
        6.61519607207968e-7,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1.15574549790308e-7,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
      ],
      fOption: "",
      fFunctions: {
        _typename: "TList",
        name: "TList",
        arr: [],
        opt: [],
      },
      fBufferSize: 0,
      fBuffer: [],
      fBinStatErrOpt: 0,
      fStatOverflows: 2,
      fArray: [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8.136696e-4, 0, 0, 0, 0, 0,
        0, 0, 0, 3.400204e-4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      ],
    };

    let obj2 = {
      _typename: "TH1F",
      fUniqueID: 1,
      fBits: 262152,
      fName: "effic_pfjeteta",
      fTitle: "Jet efficiency vs #eta",
      fLineColor: 602,
      fLineStyle: 1,
      fLineWidth: 1,
      fFillColor: 0,
      fFillStyle: 1001,
      fMarkerColor: 1,
      fMarkerStyle: 1,
      fMarkerSize: 1,
      fNcells: 52,
      fXaxis: {
        _typename: "TAxis",
        fUniqueID: 0,
        fBits: 0,
        fName: "xaxis",
        fTitle: " PF Jet #eta",
        fNdivisions: 510,
        fAxisColor: 1,
        fLabelColor: 1,
        fLabelFont: 42,
        fLabelOffset: 0.005,
        fLabelSize: 0.035,
        fTickLength: 0.03,
        fTitleOffset: 1,
        fTitleSize: 0.035,
        fTitleColor: 1,
        fTitleFont: 42,
        fNbins: 50,
        fXmin: -5,
        fXmax: 5,
        fXbins: [],
        fFirst: 0,
        fLast: 0,
        fBits2: 0,
        fTimeDisplay: false,
        fTimeFormat: "",
        fLabels: null,
        fModLabs: null,
      },
      fYaxis: {
        _typename: "TAxis",
        fUniqueID: 0,
        fBits: 0,
        fName: "yaxis",
        fTitle: " efficiency",
        fNdivisions: 510,
        fAxisColor: 1,
        fLabelColor: 1,
        fLabelFont: 42,
        fLabelOffset: 0.005,
        fLabelSize: 0.035,
        fTickLength: 0.03,
        fTitleOffset: 0,
        fTitleSize: 0.035,
        fTitleColor: 1,
        fTitleFont: 42,
        fNbins: 1,
        fXmin: 0,
        fXmax: 1,
        fXbins: [],
        fFirst: 0,
        fLast: 0,
        fBits2: 0,
        fTimeDisplay: false,
        fTimeFormat: "",
        fLabels: null,
        fModLabs: null,
      },
      fZaxis: {
        _typename: "TAxis",
        fUniqueID: 0,
        fBits: 0,
        fName: "zaxis",
        fTitle: "",
        fNdivisions: 510,
        fAxisColor: 1,
        fLabelColor: 1,
        fLabelFont: 42,
        fLabelOffset: 0.005,
        fLabelSize: 0.035,
        fTickLength: 0.03,
        fTitleOffset: 1,
        fTitleSize: 0.035,
        fTitleColor: 1,
        fTitleFont: 42,
        fNbins: 1,
        fXmin: 0,
        fXmax: 1,
        fXbins: [],
        fFirst: 0,
        fLast: 0,
        fBits2: 0,
        fTimeDisplay: false,
        fTimeFormat: "",
        fLabels: null,
        fModLabs: null,
      },
      fBarOffset: 0,
      fBarWidth: 1000,
      fEntries: 121880,
      fTsumw: 0,
      fTsumw2: 121880,
      fTsumwx: -8528.59612055855,
      fTsumwx2: 384051.46324029,
      fMaximum: -1111,
      fMinimum: -1111,
      fNormFactor: 0,
      fContour: [],
      fSumw2: [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 2.56533307002791e-8, 0, 0, 0, 7.9193095510827e-8, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      ],
      fOption: "",
      fFunctions: {
        _typename: "TList",
        name: "TList",
        arr: [],
        opt: [],
      },
      fBufferSize: 0,
      fBuffer: [],
      fBinStatErrOpt: 0,
      fStatOverflows: 2,
      fArray: [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 1.601794e-4, 0, 0, 0, 2.814523e-4, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      ],
    };

    let obj3 = {
      _typename: "TH1F",
      fUniqueID: 0,
      fBits: 262152,
      fName: "effic_pfjeteta",
      fTitle: "Jet efficiency vs #eta",
      fLineColor: 602,
      fLineStyle: 1,
      fLineWidth: 1,
      fFillColor: 0,
      fFillStyle: 1001,
      fMarkerColor: 1,
      fMarkerStyle: 1,
      fMarkerSize: 1,
      fNcells: 52,
      fXaxis: {
        _typename: "TAxis",
        fUniqueID: 0,
        fBits: 0,
        fName: "xaxis",
        fTitle: " PF Jet #eta",
        fNdivisions: 510,
        fAxisColor: 1,
        fLabelColor: 1,
        fLabelFont: 42,
        fLabelOffset: 0.005,
        fLabelSize: 0.035,
        fTickLength: 0.03,
        fTitleOffset: 1,
        fTitleSize: 0.035,
        fTitleColor: 1,
        fTitleFont: 42,
        fNbins: 50,
        fXmin: -5,
        fXmax: 5,
        fXbins: [],
        fFirst: 0,
        fLast: 0,
        fBits2: 0,
        fTimeDisplay: false,
        fTimeFormat: "",
        fLabels: null,
        fModLabs: null,
      },
      fYaxis: {
        _typename: "TAxis",
        fUniqueID: 0,
        fBits: 0,
        fName: "yaxis",
        fTitle: " efficiency",
        fNdivisions: 510,
        fAxisColor: 1,
        fLabelColor: 1,
        fLabelFont: 42,
        fLabelOffset: 0.005,
        fLabelSize: 0.035,
        fTickLength: 0.03,
        fTitleOffset: 0,
        fTitleSize: 0.035,
        fTitleColor: 1,
        fTitleFont: 42,
        fNbins: 1,
        fXmin: 0,
        fXmax: 1,
        fXbins: [],
        fFirst: 0,
        fLast: 0,
        fBits2: 0,
        fTimeDisplay: false,
        fTimeFormat: "",
        fLabels: null,
        fModLabs: null,
      },
      fZaxis: {
        _typename: "TAxis",
        fUniqueID: 0,
        fBits: 0,
        fName: "zaxis",
        fTitle: "",
        fNdivisions: 510,
        fAxisColor: 1,
        fLabelColor: 1,
        fLabelFont: 42,
        fLabelOffset: 0.005,
        fLabelSize: 0.035,
        fTickLength: 0.03,
        fTitleOffset: 1,
        fTitleSize: 0.035,
        fTitleColor: 1,
        fTitleFont: 42,
        fNbins: 1,
        fXmin: 0,
        fXmax: 1,
        fXbins: [],
        fFirst: 0,
        fLast: 0,
        fBits2: 0,
        fTimeDisplay: false,
        fTimeFormat: "",
        fLabels: null,
        fModLabs: null,
      },
      fBarOffset: 0,
      fBarWidth: 1000,
      fEntries: 63851,
      fTsumw: 0,
      fTsumw2: 63851,
      fTsumwx: -5107.36163998346,
      fTsumwx2: 212532.115736112,
      fMaximum: -1111,
      fMinimum: -1111,
      fNormFactor: 0,
      fContour: [],
      fSumw2: [
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        ,
        0,
        6.61519607207968e-7,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        3.15574549790308e-7,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
      ],
      fOption: "",
      fFunctions: {
        _typename: "TList",
        name: "TList",
        arr: [],
        opt: [],
      },
      fBufferSize: 0,
      fBuffer: [],
      fBinStatErrOpt: 0,
      fStatOverflows: 2,
      fArray: [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7.136696e-4, 0, 0, 0, 0, 0,
        0, 0, 0, 1.400204e-4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      ],
    };

    import {
      create,
      draw,
      parse,
      redraw,
      createHistogram,
      createTHStack,
      makeSVG,
    } from "https://root.cern/js/latest/modules/main.mjs";
    import { adoptRootColors } from "https://root.cern/js/latest/modules/base/colors.mjs";

    function CreateLegendEntry(obj, lbl) {
      let entry = create("TLegendEntry");
      entry.fObject = obj;
      entry.fLabel = lbl;
      entry.fOption = "l";
      return entry;
    }

    let histos = [];

    /* TODO change fName */
    /* Ref: https://root.cern/js/latest/api.htm#custom_html_thstack_src */
    /* Color arrange https://root.cern/js/latest/api.htm#custom_html_adopt_colors_src */
    /* fancy tLegend https://root.cern/js/dev/examples.htm#candle_stack */
    obj1.fLineColor = 1;
    histos.push(parse(obj1));

    obj2.fLineColor = 2;
    histos.push(parse(obj2));

    obj3.fLineColor = 7;
    histos.push(parse(obj3));

    // fLineStyle: 2,
    // fLineWidth: 2,
    let stack = createTHStack(...histos);
    stack.fTitle = obj1.fTitle + " - fname:" + obj1.fName;

    let leg = create("TLegend");
    Object.assign(leg, { fX1NDC: 0.7, fY1NDC: 0.75, fX2NDC: 0.9, fY2NDC: 0.9 });

    leg.fPrimitives.Add(CreateLegendEntry(obj1, "o1"));
    leg.fPrimitives.Add(CreateLegendEntry(obj2, "o2"));
    leg.fPrimitives.Add(CreateLegendEntry(obj3, "o3"));

    obj3.fFunctions.Add(leg, "");

    draw("id_stack", stack, "nostack,hist");
    draw("id_hist", obj1, "hist");
  </script>
</html>
